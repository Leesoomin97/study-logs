
<머리글>

데이터 분석 과정 중 금리 인상에 따른 매출 하락, 타 경쟁사 출현, 그 밖에 다른 문제상황에 영향을 받거나, 새로운 데이터 유입으로 인하여 기존 데이터에 기반한 기존 데이터 분석 모델이 더이상 적합하지 않은 상황이 발생할 수 있다. 이러한 경우 적합한 결과를 산출하기 위해서는 데이터 모델을 조정하고 다시 재작동하여 모델의 성능을 향상시켜야 할 것이다. 오늘 데이터 분석 마지막 수업에서는 실무에서 현실 변수에 대응하는 방법 중 하나인 모델 튜닝에 대해 알아보고자 한다.


<기초 지식>

-Fine tuning: 사전 훈련 모델(pre-trained model)을 이용하여 필요한 과제에 맞게 모델을 다시 학습시키는 것을 말한다. 사전훈련모델이란 대규모 데이터를 미리 학습시켜 놓은 모델을 말한다.

-미세 조정: 미세조정이란 사전 훈련 모델이 보존하고 있는 지식을 바탕으로 새로운 데이터에 필요한 목적에 특화된 모델을 만드는데 목적이 있다. 미세 조정을 통해서는 새로운 데이터의 규모와 기존에 학습한 데이터와의 유사성에 따라 4가지 경우로 나누어 다른 전략을 사용할 수 있다. 새로운 데이터가 작고 기존 데이터와는 유사한 경우/ 다른 경우, 새로운 데이터가 크고 기존 데이터와 유사한 경우 / 다른 경우로 나누어 모델의 어느 부분을 학습시킬 것인지가 달라진다.


<본문>

1.Hyper parameter tuning

(1) Parameter vs. Hyper-parameter
-Parameter: 모델 내부에서 정해지는 변수(ex.회귀식에서 회귀 계수). 직접 조정 불가.
-Hyper-Parameter: 최적의 parameter을 도출하기 위해 우리가 직접 세팅하는 값(ex. knn에서 k의 값, Random Forest에서 max_depth 값 등)

(2) 대표적 방법론
-Grid-Search: 하이퍼 파라미터를 일정한 간격으로 변경하며 최적의 파라미터를 찾아가는 기법. 모든 경우의 수를 탐색.
-Random Search: 정해진 범위 내에서 랜덤하게 하이퍼 파라미터를 탐색
-BayesianOptimization: 입력값(x)를 Input으로 하는 목적 함수 f(x)를 찾는 것, x(hyper-parameter)/f(x)(precision, recall, AUC 등) 순차적으로 하이퍼 파라미터를 업데이트해 가면서 평가를 통해 최적의 하이퍼파라미터 조합을 탐색

2. Model explanation

(1) Permutation Importance
: Feature와 실제 결과값 간의 관계(연결고리)를 끊어내도록 특성물의 값을 랜덤하게 섞은 후 모델 예측치의 오류 증가함을 측정, 만약 하나의 특성을 무작위로(shuffle) 섞었을 때 모델 오류가 증가한다면 모델이 예측할 때 해당 특성에 의존한다는 것을 의미
: 모델의 성능이 떨어지면 중요한 Feature라고 볼 수 있음
: 모델의 성능이 그대로거나 좋아지면 중요하지 않은 Feature라고 볼 수 있음

(2) Shapley Value
: 특정 Feature가 예측값에 얼마나 기여하는지 파악하기 위해 특정 변수와 관련된 모든 변수 조합들을 입력시켰을 떄 나온 결과값과 비교를 하면서 변수의 기여도를 계산하는 방식. 즉 특정 Feature(on/off)가 예측값에 얼마나 영향을 끼쳤는지 탐색.

3. Modeling operation(최종 모델 활용 운영 준비)

(1) Target 고객 수준 결정
: 최종 Selection된 model 기준으로 재구매 가능성이 높은 Target 고객을 선정

(2) Model Save
: Model Operation을 위해 모델 및 하이파라미터 저장 후 운영시 Model 및 하이파라미터 load

(3) Mart 생성
: Mart를 생성할 때 사용했던 전처리 및 완료 코드를 저장 후 운영시 불러와 월별 새로운 Mart 생성

(4) Model Input
: 생성된 Mart를 Input하여 결과를 추출 (proda 예측확률)

(5) Target 추출
: 1단계에서 선정한 threshold 기준으로 Target 고객 추출


<마무리>

새로운 데이터가 유입될 경우 처음부터 다시 모델을 설정하는 것은 기존 모델을 설정하는데 소모된 시간과 비용을 모두 낭비하는 행동일 것이다. 그렇기에 모델을 새로 생성하는 것보다는 기존 모델에서 유의해야 했던 특성이 변동하였는지 살펴보고, 변동하였다면 AUC가 가장 큰 새 특성을 찾아 그에 맞추어 튜닝하는 것이 보다 효율적인 방법일 것이다.

출처: 패스트캠퍼스 온라인 수업, 서울대학교 Ai 연구원
#패스트캠퍼스 #패스트캠퍼스AI부트캠프 #업스테이지패스트캠퍼스 #UpstageAILab #국비지원 #패스트캠퍼스업스테이지에이아이랩 #패스트캠퍼스업스테이지부트캠프
﻿
